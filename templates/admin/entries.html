{% extends "admin/base.html" %}
{% block title %}Module Entries{% endblock %}
{% block page_title %}Module Entries{% endblock %}
{% block topbar_actions %}<a href="{{ url_for('admin_entry_new') }}" class="btn btn-primary"><i class="fas fa-plus"></i> New Entry</a>{% endblock %}

{% block admin_content %}
<!-- Help Accordion: Module Entries -->
<div class="help-accordion">
<div class="help-accordion-toggle" onclick="toggleHelpAccordion(this)">
<span style="font-size:18px">ğŸ“</span>
<h4>â„¹ï¸ How Module Entries Work</h4>
<svg class="ha-chevron" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M5.23 7.21a.75.75 0 011.06.02L10 11.168l3.71-3.938a.75.75 0 111.08 1.04l-4.25 4.5a.75.75 0 01-1.08 0l-4.25-4.5a.75.75 0 01.02-1.06z"/></svg>
</div>
<div class="help-accordion-body"><div class="help-accordion-inner">
<h5>What are Module Entries?</h5>
<p><strong>Entries</strong> are individual pieces of content within a module. For example, a "Sacred Stories" module might have entries like "Krishna lifting Govardhan Hill" or "Ratha Yatra Festival".</p>
<h5>Linking Entries to Dhams</h5>
<p>Each entry can be <strong>linked to a T1 Holy Dham</strong>. When linked, the entry appears in the "Related Content" section on that Dham's frontend page â€” connecting stories, guides, and resources directly to the places they're about.</p>
<h5>Entry Statuses</h5>
<ul>
<li><strong>Draft:</strong> Saved but not visible to visitors â€” use this to prepare content</li>
<li><strong>Published:</strong> Live and visible on the frontend</li>
</ul>
<div class="ha-tip">ğŸ’¡ <strong>Tip:</strong> Use the module filter buttons above the table to quickly see entries for a specific module. Custom Fields you create will also appear in entry forms based on their "Applies To" setting.</div>
</div></div>
</div>

<div style="display:flex;gap:8px;margin-bottom:20px;flex-wrap:wrap">
<a class="btn btn-sm {{ 'btn-primary' if not current_mod else 'btn-secondary' }}" href="{{ url_for('admin_entries') }}">All</a>
{% for mod in modules %}
<a class="btn btn-sm {{ 'btn-primary' if current_mod == mod.id else 'btn-secondary' }}" href="{{ url_for('admin_entries', mod_id=mod.id) }}">{{ mod.icon }} {{ mod.name }}</a>
{% endfor %}
</div>

<div class="admin-card">
{% if entries %}
<div style="overflow-x:auto">
<table class="admin-table">
<thead><tr><th>Title</th><th>Module</th><th>Linked Place</th><th>Status</th><th>Updated</th><th>Actions</th></tr></thead>
<tbody>
{% for entry in entries %}
<tr>
<td><a href="{{ url_for('admin_entry_edit', entry_id=entry.id) }}" style="font-weight:600;color:var(--text)">{{ entry.title }}</a></td>
<td><span style="font-size:14px">{{ entry.module_icon }} {{ entry.module_name }}</span></td>
<td style="font-size:13px;color:var(--text-light)">{{ entry.place_title or 'â€”' }}</td>
<td><span class="badge badge-{{ entry.status }}">{{ entry.status }}</span></td>
<td style="font-size:12px;color:var(--text-light)">{{ entry.updated_at[:10] if entry.updated_at else '' }}</td>
<td class="actions">
<a href="{{ url_for('admin_entry_edit', entry_id=entry.id) }}" class="btn btn-secondary btn-icon btn-sm"><i class="fas fa-edit"></i></a>
<form method="POST" action="{{ url_for('admin_entry_delete', entry_id=entry.id) }}" style="display:inline" onsubmit="return confirm('Delete?')">
<button class="btn btn-danger btn-icon btn-sm"><i class="fas fa-trash"></i></button>
</form>
</td>
</tr>
{% endfor %}
</tbody>
</table>
</div>
{% else %}
<div class="empty"><span class="icon">ğŸ“</span><h3>No entries yet</h3><p>Create entries to populate your modules.</p></div>
{% endif %}
</div>
{% endblock %}
