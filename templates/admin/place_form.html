{% extends "admin/base.html" %}
{% block title %}{{ 'Edit' if editing else 'New' }} Place{% endblock %}
{% block page_title %}{{ 'Edit' if editing else 'New' }} Holy Place{% endblock %}
{% block topbar_actions %}
{% if editing %}
<a href="{{ url_for('place_detail', slug=place.slug) }}" target="_blank" class="btn btn-secondary"><i class="fas fa-eye"></i> View</a>
{% endif %}
{% endblock %}

{% block admin_content %}
<form method="POST" class="admin-card">
<div class="admin-card-body">
<div class="form-group">
<label>Title *</label>
<input name="title" class="form-control" value="{{ place.title if editing else '' }}" required placeholder="e.g. Kedarnath Temple">
</div>

<div class="form-row">
<div class="form-group">
<label>City</label>
<input name="city" class="form-control" value="{{ place.city if editing else '' }}" placeholder="e.g. Rudraprayag">
</div>
<div class="form-group">
<label>State</label>
<input name="state" class="form-control" value="{{ place.state if editing else '' }}" placeholder="e.g. Uttarakhand">
</div>
</div>

<div class="form-row">
<div class="form-group">
<label>Country</label>
<input name="country" class="form-control" value="{{ place.country if editing else 'India' }}" placeholder="India">
</div>
<div class="form-group">
<label>Featured Image URL</label>
<input name="featured_image" class="form-control" value="{{ place.featured_image if editing else '' }}" placeholder="filename or URL">
</div>
</div>

<div class="form-group">
<label>Short Description</label>
<textarea name="short_description" class="form-control" rows="3" placeholder="Brief description for cards and previews...">{{ place.short_description if editing else '' }}</textarea>
</div>

<div class="form-group">
<label>Full Content (Rich Editor)</label>
<input type="hidden" name="full_content" id="full_content" value="{{ place.full_content if editing else '' }}">
<div class="rich-editor" data-target="full_content" style="background:white;min-height:300px"></div>
</div>

<div class="form-row">
<div class="form-group">
<label>Latitude</label>
<input name="latitude" class="form-control" type="number" step="any" value="{{ place.latitude if editing and place.latitude else '' }}" placeholder="e.g. 30.7352">
</div>
<div class="form-group">
<label>Longitude</label>
<input name="longitude" class="form-control" type="number" step="any" value="{{ place.longitude if editing and place.longitude else '' }}" placeholder="e.g. 79.0669">
</div>
</div>

<div class="form-group">
<label>Tags</label>
<div class="tag-select">
{% for tag in tags %}
<label>
<input type="checkbox" name="tags" value="{{ tag.id }}" {{ 'checked' if editing and tag.id in place_tags else '' }}>
<span style="width:8px;height:8px;border-radius:50%;background:{{ tag.color }}"></span> {{ tag.name }}
</label>
{% endfor %}
</div>
</div>

<div class="form-row">
<div class="form-group">
<label>Status</label>
<select name="status" class="form-control">
<option value="draft" {{ 'selected' if editing and place.status=='draft' }}>Draft</option>
<option value="published" {{ 'selected' if editing and place.status=='published' }}>Published</option>
</select>
</div>
<div class="form-group" style="display:flex;align-items:end;padding-bottom:12px">
<label class="form-check">
<input type="checkbox" name="is_featured" {{ 'checked' if editing and place.is_featured }}>
Featured on Homepage
</label>
</div>
</div>
</div>

<div style="padding:16px 24px;border-top:1px solid var(--border);display:flex;gap:12px;justify-content:flex-end">
<a href="{{ url_for('admin_places') }}" class="btn btn-secondary">Cancel</a>
<button type="submit" class="btn btn-primary"><i class="fas fa-save"></i> {{ 'Update' if editing else 'Create' }} Place</button>
</div>
</form>
{% endblock %}
